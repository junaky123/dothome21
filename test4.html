<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        .div1{
            background-color: skyblue;
            color: white;
            border-radius: 10px;
            padding: 10px;
        }
        .div2{
            background-color: red;
            color: white;
            border-radius: 10px;
            padding: 10px;
        }
        .div3{
            background-color: orange;
            color: white;
            border-radius: 10px;
            padding: 10px;
        }
        .table tr th{
            font-size: 20px;
        }
    </style>
</head>
<body>
    <h1>매크로</h1>
    <h2>1.전처리기</h2>
    <div class="div1">컴파일러가 소스 파일을 <span style="color: red;">컴파일 하기 전에 먼저 수행</span>되는 프로그램</div>
    <ol>
        <li>프로그래머가 작성한 소스 파일이 컴파일될 수 있도록 준비함</li>
        <li>전처리기 문장은 <span style="color: red;">'#'으로 시작</span></li>
    </ol>
    사진1
    <table class="table">
        <tr>
            <th>전처리기 문장</th>
            <th>기능</th>
        </tr>
        <tr>
            <td>#define</td>
            <td>매크로를 정의</td>
        </tr>
        <tr>
            <td>#include</td>
            <td>헤더 파일을 포함</td>
        </tr>
        <tr>
            <td>#if,#else,#endif</td>
            <td>조건에 따라 컴파일</td>
        </tr>
        <tr>
            <td>#ifdef</td>
            <td>매크로가 정의된 경우에 컴파일</td>
        </tr>
        <tr>
            <td>#ifndef</td>
            <td>매크로가 정의되지 않는 경우에 컴파일</td>
        </tr>
    </table>

    <h2>2.매크로 상수</h2>
    사진2
    <p>전처리기:소스 파일에서 매크로 상수가 사용된 곳을 모두 찾아서 정의된 문자열로 대치</p>
    <pre>
        <code>
            average = sum/MAX;  //average = sum/100;으로 처리됨
            printf("MAx=%d",MAX);  //printf("MAx=%d",100);으로 처리됨
        </code>
    </pre>
    <pre>
        <code>
            <span style="color: red;">#define PI3.1415</span>   //실수형 상수를 매크로 상수로 정의
            area = <span style="color: red;">PI</span>*radius*radius;   //area =3.1415*radius*radius;로 처리

            <span style="color: red;">#define MSG"잘못 입력했습니다."</span>     //문자열 상수를 매크로 상수로 정의
            if(n&lt;0)
            printf(<span style="color: red;">MSG</span>)     //printf("잘못 입력했습니다.")로 처리
        </code>
        <code>
            <span style="color: red;">#define PRT pintf</span> //함수명을 매크로 상수로 정의
            <span style="color: red;">PRT</span>("hello");  //printf("hello")로 처리

            <span style="color: red;">#define UINT unsigned int</span>  //데이터형을 매크로 상수로 정의
            <span style="color: red;">UINT</span>num;  //unsugned int num;으로 처리
        </code>
    </pre>

    <h2>3.매크로 함수</h2>
    <ol>
        <li>매크로 함수는 함수처럼 인자를 갖는 매크로</li>
        <li>매크로 상수처럼 매크로 함수가 사용되는 곳에 문자열 대치를 통해서 코드를 확장함
        사진3
            <pre>
                <code>
                    <span style="color: red;">#difune SQUARE(n) n*n</span>
                    int main (void)
                    {
                        int result = SQUARE(3); //int result = 3*3;으로 문자열 대치됨
                    }
                </code>
            </pre>
        </li>
        <li>매크로 함수는 함수인 것처럼 보이지만 사실은 함수가 아님</li>
        <li>컴파일 시에 인자의 데이터형 검사를 수행하지 않으며,인자를 매개변수로 전달하는 함수 호출 과정이 수행되지 않음</li>
        <li>매크로 함수 사용 시 문자열 대치 과정에서 잘못된 결과가 만들어질 수도 있음</li>
        <pre>
            <code>
                #difine SQUARE(n) n*n
                ...
                result = SQUARE(1+2);   //result = 1+2+*1+2;로 문자열 대치됨
            </code>
        </pre>
        사진4
    </ol>
    <div class="div1">매크로 함수의 장점</div>
    <p>매크로 함수를 사용하면 <span style="color: red;">프로그램의 실행 속도가 빨라짐</span><br>
    ->매크로 함수를 사용할 떄는 함수 호출이 일어나지 않으므로 함수 호출의 오버헤드를 줄일 수 있음</p>

    <div class="div2">매크로 함수의 단점</div>
    <ul>
        <li>매크로 함수를 많이 사용하는 프로그램은 <span style="color: red;">프로그램의 크기가 커짐</span><br>
        ->일반 함수 코드는 한 번만 컴파일해서 만들어두고,함수 코드를 필여할 떄마다 반복해서 호출함<br>
        ->매크로 함수는 사용되는 곳마다 매크로 함수를 확장한 코드가 복사됨</li>
        <li>매크로 함수를 사용하면,<span style="color: red;">코드가 알아보기 어려워짐</span></li>
    </ul>
    
    <h2>4.예약 매크로</h2>
    <table class="table">
        <tr>
            <th>매크로</th>
            <th>설명</th>
        </tr>
        <tr>
            <th>__DATE__</th>
            <th>최근에 컴파일한 날짜</th>
        </tr>
        <tr>
            <th>__FILE__</th>
            <th>소스파일의 이름을 절대 경로와 함께함</th>
        </tr>
        <tr>
            <th>__LINE__</th>
            <th>소스파일에서 해당 문장이 있는 줄 번호</th>
        </tr>
        <tr>
            <th>__TIME__</th>
            <th>최근에 컴파일한 시각</th>
        </tr>
        <tr>
            <th>__TIMESTAMP__</th>
            <th>소스파일을 수정한 시각</th>
        </tr>
    </table>

    <hr>

    <h1>조건부 컴파일</h1>
    <h2>1.#if,#else,#endif</h2>
    <ol>
        <li>특정 조건이 만족할 떄만 코드를 컴파일함</li>
        <li>상황에 따라서 특정 코드를 컴파일하게 또는 컴파일하지 않게 만들 수 있음</li>
        <li>이식성 있는 코드를 개발할 때 유용함</li>
        사진5
        <li>#if의 조건식에는 매크로를 정수와 비교하는 관계 연산자가 주로 사용되고,산술 연산자,논리 연산자 등이 사용될 수 있음
            <pre>
                <code>
                    #if INFO__LEVEL = 1 //INFO_LEVEL 매크로가 1이면 다음 문장을 컴파일 함
                    문장;
                    #endif
                </code>
            </pre>
        </li>
        <li>#if의 조건식에서 매크로를 실수나 문자열과 비교할 수 없음
            <pre>
                <code>
                    #if FACTOR ! = 0.5                 //실수와 비교할 수 없으므로 컴파일 에러
                    #if ERR_MSG ="메모리 할당 실패"     //문자열과 비교할 수 없으므로 컴파일 에러
                </code>
            </pre>
        </li>
        <li>#if에는 반드시 짝이 되는 #endif가 필요하며,#else를 함꼐 사용할 수도 있음
            <pre>
                <code>
                    #if 조건
                    문장1;            //■조건이 참이면 문장1을 컴파일하고,
                    #else             // 조건1 거짓이면 문장2를 컴파일함
                    문장2;            // ■#else 문에 다른 조건을 다시 검사하려면
                    #endif            //#elif를 사용함
                </code>
            </pre>
        </li>
        <li>#if,#endif에서는 컴파일할 문자이 여러 개여도{}로 묶어줄 필요가 없음</li>
        <li>#if 안에 다른 #if를 중첩해서 사용할 수 있으며,각각의 #if마다 #endif가 하나씩 짝을 이루어야 함</li>
    </ol>
    
    <h2>2.#ifdef</h2>
    <ol>
        <li>"if defined"라는 의미</li>
        <li>#ifdef는 특정 매크로의 정의 여부에 따라 #ifdef와 #endif사이의 문장을 컴파일할지 결정</li>
        사진6
        <li>DEBUG 매크로 정의 시에만 함수 정보를 출력하는 경우
            <pre>
                <code>
                    #ifdef DEBUG                                |
                        printf("GetFactorial 함수 호출.") ;      |
                        printf("n=%d\n",n);                     |------//DEBUG 매크로가 정의된 경우에만 출력문을 수행함
                    #endif                                      |

                        if(i&lt;=1)
                            return 1;
                        return n * GetFactorial(n-1);
                    }
                </code>
            </pre>
        </li>
        <li>출력문에 수행되려면 DEBUG 매크로 정의가 필요함
            <pre>
                <code>
                    #define DEBUG   //DEBUG 매크로 심볼을 정의함
                </code>
            </pre>
        </li>
    </ol>

    <h2>3.#ifndef</h2>
    <div class="div3">"if not defined"라는 의미</div>
    <div class="div2">#ifnded 다음의 매크로가 정의되지 않는 경우에만 #ifndef와 #endif 사이의 문장이 컴파일</div>

    <h2>핵심요약</h2>
    <div class="well">
        <h2>매크로</h2>
        <ul>
            <li>전처리기는 컴파일 전 수행되는 프로그램임</li>
            <li>매크로 상수와 함수는 컴파일 시 대치되는 문장임</li>
            <li>예약 매크로는 미리 정의된 매크로 상수임</li>
        </ul>
    </div>
    <div class="well">
        <h2>조건부 컴파일</h2>
        <ul>
            <li>조건부 컴파일은 특정 조건이 만족할 때만 코드를 컴파일함</li>
            <li>#ifdef,#ifndef는 매크로 상수의 정의 여부에 따라 컴파일함</li>
        </ul>
    </div>
</body>
</html>